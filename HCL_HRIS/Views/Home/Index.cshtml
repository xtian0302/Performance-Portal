@using System.Globalization;
@model IEnumerable<HCL_HRIS.Models.announcement>
@{
    ViewBag.Title = "Home Page";
}
<style>
    .fc-bgevent {
        color: white !important;
        font-weight: bolder;
        opacity: 1 !important;   
    }

    .fc-title {
        font-weight: bold;
        text-align: center !important;
    }

    .fc-content {
        text-align: center;
    }
</style>
<div class="row ">
    <div class="col-md-6" style="min-height:800px;padding:0px">
        <div class="card no-rad-brtr" style="min-height:800px;padding:0px">
            <div class="card-header" style="padding:4.5px;">
                Scorecard as of November 29, 2019
            </div>
            <div class="card-body" style="padding:3px;">
                <div class="card">
                    <div class="card-header" style="padding:3px;">
                        Quality Scores
                    </div>
                    <div class="card-body" style="padding:3px;font-size:0.75rem; overflow-x:auto;">
                        <table class="table-bordered table text-center" style="color:black">
                            <thead>
                            </thead>
                            <tbody>
                                <tr>
                                    <th rowspan="3" style="vertical-align : middle;text-align:center;">B.C.</th>
                                    <td colspan="2">Prev Month</td>
                                    <td colspan="2">Current Month</td>
                                    <td colspan="2">Week 1</td>
                                    <td colspan="2">Week 2</td>
                                    <td colspan="2">Week 3</td>
                                    <td colspan="2">Week 4</td>
                                    <td colspan="2">Week 5</td>
                                </tr>
                                <tr>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                </tr>
                                <tr>
                                    <td>95%</td>
                                    <td>#2</td>
                                    <td>96%</td>
                                    <td>#1</td>
                                    <td>92%</td>
                                    <td>#4</td>
                                    <td>98%</td>
                                    <td>#1</td>
                                    <td>90%</td>
                                    <td>#4</td>
                                    <td>89%</td>
                                    <td>#9</td>
                                    <td>90%</td>
                                    <td>#7</td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table-bordered table text-center" style="color:black">
                            <thead>
                            </thead>
                            <tbody>
                                <tr>
                                    <th rowspan="3" style="vertical-align : middle;text-align:center;">E.U.C.</th>
                                    <td colspan="2">Prev Month</td>
                                    <td colspan="2">Current Month</td>
                                    <td colspan="2">Week 1</td>
                                    <td colspan="2">Week 2</td>
                                    <td colspan="2">Week 3</td>
                                    <td colspan="2">Week 4</td>
                                    <td colspan="2">Week 5</td>
                                </tr>
                                <tr>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                </tr>
                                <tr>
                                    <td>95%</td>
                                    <td>#2</td>
                                    <td>96%</td>
                                    <td>#1</td>
                                    <td>92%</td>
                                    <td>#4</td>
                                    <td>98%</td>
                                    <td>#1</td>
                                    <td>90%</td>
                                    <td>#4</td>
                                    <td>89%</td>
                                    <td>#9</td>
                                    <td>90%</td>
                                    <td>#7</td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table-bordered table text-center" style="color:black">
                            <thead>
                            </thead>
                            <tbody>
                                <tr>
                                    <th rowspan="3" style="vertical-align : middle;text-align:center;">C.C.</th>
                                    <td colspan="2">Prev Month</td>
                                    <td colspan="2">Current Month</td>
                                    <td colspan="2">Week 1</td>
                                    <td colspan="2">Week 2</td>
                                    <td colspan="2">Week 3</td>
                                    <td colspan="2">Week 4</td>
                                    <td colspan="2">Week 5</td>
                                </tr>
                                <tr>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                    <td>Score</td>
                                    <td>Rank</td>
                                </tr>
                                <tr>
                                    <td>95%</td>
                                    <td>#2</td>
                                    <td>96%</td>
                                    <td>#1</td>
                                    <td>92%</td>
                                    <td>#4</td>
                                    <td>98%</td>
                                    <td>#1</td>
                                    <td>90%</td>
                                    <td>#4</td>
                                    <td>89%</td>
                                    <td>#9</td>
                                    <td>90%</td>
                                    <td>#7</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6" style="padding:0px">
        <div class="col-12 no-rad-bltl" style="min-height:33.33%;height:1px;border-bottom-right-radius: 0px !important;">
            <div class="row" style="min-height: 100%;">
                <div class="col-6 card no-rad-bltl" style="padding:0px;border-bottom-right-radius: 0px !important;border-top-right-radius: 0px !important;">
                    <div class="card-header" style="padding:4.5px;">
                        Announcements
                    </div>
                    <div class="card-body" style="font-size:0.9rem;">
                        @foreach (var item in Model)
                        {
                            <h5>@item.announcement_title</h5>
                            <p>@item.announcement_details</p>
                        }
                    </div>
                </div>
                <div class="col-6 card no-rad-bltl" style="padding:0px;border-bottom-right-radius: 0px !important;">
                    <div class="card-header" style="padding:4.5px;">
                        Track Top 5 Performers
                    </div>
                    <div class="card-body" style="padding:4.5px;font-size:0.75rem;">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item font-weight-bold">1. Agent 1</li>
                            <li class="list-group-item">2. Agent 2</li>
                            <li class="list-group-item">3. Agent 3</li>
                            <li class="list-group-item">4. Agent 4</li>
                            <li class="list-group-item">5. Agent 5</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 card no-rad-bltl" style="min-height:33.33%;padding:0px;border-bottom-right-radius: 0px !important;border-top-right-radius: 0px !important;">
            <div class="card-header" style="padding:4.5px;">
                Attendance and Pay Hours
            </div>
            <div class="card-body" style="padding:3px;font-size:0.75rem;text-align:center;overflow-y:scroll;max-height:230px;">
                @DateTime.Now.ToString("MMMM", CultureInfo.CreateSpecificCulture("en"))
                <a href="~/attendance/Index" class="btn btn-outline-dark float-right">See All...</a>
                <div id="calendar" style="width:450px;margin-left:25px;"></div>
            </div>
        </div>
        <div class="col-12 card no-rad-bltl" style="min-height:33.33%;padding:0px;border-top-right-radius: 0px !important;">
            <div class="card-header" style="padding:4.5px;">
                Chat
            </div>
            <div class="card-body" style="padding:3px;font-size:0.75rem;">
                <ul class="nav nav-tabs" style=" ">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Team Leader</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Team Members</a>
                    </li>
                </ul>
                <!-- Chat Box -->
                <div class="chatbox" id="chatbox">
                </div>
                <form onsubmit="return false">
                    <div class="input-group mb-3" style="border-top-left-radius:0px;border-top-right-radius:0px;margin-bottom:0px !important;">
                        <input type="text" id="chatMessage" required class="form-control" style="border-top-left-radius:0px;" placeholder="Enter Message..." aria-label="Enter Message..." aria-describedby="basic-addon2">
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" id="tlSend" style="border-top-right-radius:0px;" type="submit">Send</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        var uri = '../api/chats';
        $.getJSON(uri).done(function (data) {
            console.log(data);
            $.each(data, function (key, item) {
                // Add a list item for the product.
                $("#chatbox").append('<span><b>' + item.chat_from + ' : </b>' + item.chat_message + '</span><br />');
                console.log(item.chat_message);
                $("#chatbox").scrollTop( 100000);
            });

        });
        $("#tlSend").click(function () {
            if ($("#chatMessage").val() == "") {
                return;
            }
            // Post New Chat
            var chat = {
                chat_from: @User.Identity.Name,
                chat_message: $("#chatMessage").val(),
                chat_to: @User.Identity.Name,
                datetime_read: null,
                datetime_sent: null,
            };
            $.ajax({
                type: "POST",
                data: JSON.stringify(chat),
                url: uri,
                contentType: "application/json"
            }).done(function (res) {
                    clearChat();
                    console.log('res', res);
                     $("#chatMessage").val("")
                    $.getJSON(uri).done(function (data) {
                            $.each(data, function (key, item) {
                            // Add a list item for the product.
                                $("#chatbox").append('<span><b>' + item.chat_from + ' : </b>' + item.chat_message + '</span><br />');

                            });
                    $("#chatbox").scrollTop( 100000 );
                    });
                $("#chatMessage").focus();
            });
        });
    });

    //Attendance Calendar
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: [ 'dayGrid','bootstrap' ],
            themeSystem: 'bootstrap',
            eventOrder: 'eventProperty',
            fixedWeekCount: false,
            header: false,
            eventRender : function(info) {
                   const props = info.event.extendedProps,
                      rendering = info.event.rendering;
                   if(rendering == "background") {
		            $(info.el).text(info.event.title);
		            $(info.el).css({ "color": "#ffffff !important", "text-align": "center", "vertical-align": "middle" });
                 }
            }
        });

    calendar.addEvent({
        title: 'A',
        start: '2019-12-06',
        allDay: true,
        backgroundColor: "Red",
        textColor: "white",
        rendering: 'background'
    });
    calendar.addEvent({
        title: '9.5 hrs',
        start: '2019-12-04',
        allDay: true,
        backgroundColor: "Green",
        textColor: "white",
        rendering: 'background'
    });
         calendar.addEvent({
        title: '30 mins',
        start: '2019-12-05',
        allDay: true,
        backgroundColor: "Orange",
        textColor: "white",
        rendering: 'background'
    });
    calendar.render();
      });

    // Utilities
    function clearChat(){
        $('#chatbox > span').remove();
        $('#chatbox > br').remove();
    }
</script>